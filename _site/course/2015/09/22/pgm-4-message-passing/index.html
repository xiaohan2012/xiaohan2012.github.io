
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	
	<title>PGM course: Message Passing</title>
    
	
	<meta name="author" content="Han Xiao">
	
	<link rel="stylesheet" href="/assets/themes/Snail/css/jquery.fancybox.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/main.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/pages/journal.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/team.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/static.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/errors.css">
	<link rel="stylesheet" href="/assets/themes/Snail/google-code-prettify/prettify.css">
	<link rel="shortcut icon" href="/assets/themes/Snail/img/favicon.ico">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
	<script src="/assets/themes/Snail/google-code-prettify/prettify.js"></script>
	<script type="text/javascript">
	  $(function(){
		$("pre code").addClass("prettyprint linenums");
		prettyPrint();
	  });
	</script>
	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<!--[if lt IE 9]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">
</head>
<body>
	<noscript>
		&amp;lt;div id="no-js"&amp;gt;Please enable JavaScript in your browser to experience / fully&amp;lt;/div&amp;gt;
	</noscript>
    <div id="page-container">
		<div>
			<nav>
	<div id="nav-l">
	</div>
	<div id="nav-c">
		<ul id="nav-list" style="width: 700px;">
			<li id="home"><a href="/">Home</a></li>
			
			
			
				
				  
				
			 
				
				  
					
					<li id = "About Me"><a href="/about.html">About Me</a></li>
					
				  
				
			 
				
				  
					
					<li id = "Archive"><a href="/archive.html">Archive</a></li>
					
				  
				
			 
				
				  
				
			 
				
				  
					
					<li id = "Categories"><a href="/categories.html">Categories</a></li>
					
				  
				
			 
				
			 
				
				  
				
			 
				
				  
				
			 
				
				  
				
			 
				
				  
					
					<li id = "Tags"><a href="/tags.html">Tags</a></li>
					
				  
				
			 
			
			
		</ul>
		<form id="nav-search" method="GET" action="/search.html">
			<div id="search-right-pix">
				<div id="search-left-pix">
					<div id="search-center-pix">
						<div id="search-icon-pix"></div>
						<input name="query" type="text" placeholder="Search">
					</div>
				</div>
			</div>
		</form>
		
		
	</div>
	<div id="nav-r">
	</div>
</nav>
			<div id="page-content">
				
<div id="page-content">
	<div class="cont932">
	<div id="journal-articles-block">
		<div class="journal-article">
			<div class="journal-post-info">
				<div class="journal-cat-box">
				
				
				<div class="journal-cat-box">

<a href="/categories.html#course-ref" title="course">
	course

</a>
</div>
				
				</div>
			</div>
			<div class="journal-body">
				<h1 class="journal-title">PGM course: Message Passing<span class="author"></span>
				</h1>
				<span class="the-article">
				<h2 id="introduction">Introduction</h2>

<p>The lecture is organized by the following motivation:</p>

<ol>
  <li>variable elimination is inefficient for multiple queries –&gt; message passing(belief propagation) which can cache <em>messages</em> and recombine them later for different queries</li>
  <li>message passing is consistent on trees while not for non-tree. However, tree-like graph can be converted to <em>Factor Tree</em> in order to produce consistent result</li>
  <li>Junction tree algorithm as a general exact inference algorithm for any graph structure.</li>
</ol>

<h2 id="from-elimination-to-message-passing">From Elimination to Message Passing</h2>

<p>Elimination = message passing on <em>clique trees</em>, where each clique is the resulting elimination clique from certain step of variable elimination.</p>

<p>One run of variable elimination only answer <strong>one</strong> query. When we have <strong>multiple</strong> queries(say, an online inference system), <em>messages</em> maybe reused.</p>

<h2 id="message-passing-on-tree">Message passing on tree</h2>

<p>Three types of trees:</p>

<ul>
  <li>undirected</li>
  <li>directed: no v-structure</li>
  <li>poly tree: can have multiple parents(the v-structure)</li>
</ul>

<p>We talk about undirected and directed tree. Undirected tree is equivalent to directed tree as they make the same conditional independencies.</p>

<p>A unique path between any pair of node ensures the correctness of our algorithm.</p>

<p>Definition of <em>message</em>:</p>

<script type="math/tex; mode=display">m_{ji}(x_i) = \phi(x_i) \sum\limits_{x_j} \phi(x_i, x_j) \prod\limits_{k \in N(j) \setminus i} m_{kj}(x_j)</script>

<p>Interpretation of message: a belief from \(x_j\) to \(x_i\)</p>

<p>Implication: node can send its message to one of its neighbor once it has received messages from <strong>all other</strong> neighbors.</p>

<p>Elimination and message passing are equivalent on trees: every elimination of variable can be considered as passing one message.</p>

<p>Complexity of computing node marginals using dynamic programming: \(2C\), where \(C\) is the complexity of message passing on the tree in one direction. We need two passes(in each direction of the tree).</p>

<p>Belief Propagation algorithm:</p>

<ol>
  <li>Evidence</li>
  <li>Choose the root: determines how messages are passed(unique in tree)</li>
  <li>Collect: recursive procedure that collects messages from neighbors. From leaf to root</li>
  <li>Distribute: similar to Collect but in the reverse direction. From root to leaf</li>
  <li>Compute marginal</li>
</ol>

<p>Sequential and parallel(asynchronous) are both possible</p>

<p>BP on tree is correct/consistent. For tree: only one way of passing message from one node to the other so that the result is consistent.</p>

<h2 id="message-passing-on-non-tree">Message passing on non-tree</h2>

<p>Inconsistency on non-tree, for example, the <em>Misconception</em> example. The same query on two <strong>different</strong> message passing ways get two different results.</p>

<p>Basic idea: we can <strong>convert</strong> the non-tree graph into a tree…</p>

<p>Factor Graph: graph with variable node and factor node. This type of graph makes explicit the factorization.</p>

<p>Factor tree: the factor graph in which the distinction between variable nodes and factor nodes are ignored and such graph is an undirected tree</p>

<p><strong>Q</strong>: general algorithm to perform this conversion?</p>

<p>Once we have a tree, we can enjoy consistency of query result,</p>

<p>Two types of messages during message passing on factor tree:</p>

<ol>
  <li>from variable to factor: without marginalization</li>
  <li>from factor to variable: with marginalization</li>
</ol>

<p>Poly-trees is treated differently in contrast to undirected/directed tree, we need to convert it to factor tree. (why?)</p>

<p>Disadvantages of factor tree conversion: we will might encounter a large clique(which is the bottleneck of computation).</p>

<p>Example: the \(X_2, X_3, X_4\) clique. When passing messages from \(X_2\) and \(X_3\) to \(X_4\) through their factor, we need to sum over \(X_2, X_3\) together.</p>

<p>More extreme example: Ising model.</p>

<p>One possible factor tree version is columns/rows of nodes as factors and being connected in a chain.</p>

<p>BP works for:</p>

<ul>
  <li>tree</li>
  <li>tree-like graphs</li>
  <li>poly-trees</li>
</ul>

<h2 id="max-product-algorithm">Max-product algorithm</h2>

<p>computing maximum a posterior(MAP)</p>

<p>replace <em>sum</em> with <em>max</em> and extra <em>bookkeeping(?)</em>.</p>

<h2 id="inference-on-general-gm----junctionclique-tree-algorithm">Inference on general GM – Junction(clique) tree algorithm</h2>

<p>Junction tree algorithm: obsolete and complicated but illustrates the principles behind exact and approximate inference.</p>

<p><strong>Q</strong>: why obsolete?</p>

<p>Moralize directed graph -&gt; undirected graph</p>

<h3 id="why-triangulation">why triangulation?</h3>

<p>It can be shown that: if we want local consistency, we must triangulate.</p>

<p>If no triangulation for example the Misconception example, we will disobey the running intersection property, thus inconsistency.</p>

<p>Local consistency property: see slides.</p>

<p>Guarantee of consistency: running interaction property, which is, when two factors share some node, there should be an edge connecting them.</p>

<p><strong>Q</strong>: how can we add edges for triangulation without changing the conditional independence assumption?</p>

<p>We can manipulate the factors without changing the conditional independence. For example \(\phi(X_1, X_2, X_3)\) can equal to \(\phi(X_1, X_2) \phi(X_2, X_3)\). In this way, independence between \(X_1, X_3\) is ensured.</p>

<p>How to triangulate? Different triangulation can produce complexity on inference.</p>

<p>Several methods to update: Hugin update, Shafer-Shenoy update.</p>

<h3 id="summary">Summary</h3>

<p>Junction tree is not equivalent to the graphical model. It’s just a device to specify how message passing is done in the graphical model.</p>

<p>Workflow of junction tree algorithm:</p>

<ol>
  <li>moralize the graph(because we don’t want to introduce more conditional independency)</li>
  <li>triangulate(NP-hard, but heuristic exists)</li>
  <li>build clique tree(using maximum-spanning tree algorithm. <strong>why using this algorithm?</strong>)</li>
  <li>BP</li>
</ol>

<p>First three steps ensure a junction tree with running intersection property, where local consistency guarantees.</p>

<p>Works for exact inference on general graph. Complexity depends on maximum clique.</p>

<h2 id="example-forward-algorithm-for-hmm">Example: forward algorithm for HMM</h2>

<p>Define:</p>

<script type="math/tex; mode=display">\alpha_t^k = P(Y_t = k, \mathbf{X})</script>

<p>which can be seen as the message of \( Y_{t} \).</p>

<p>Then:</p>

<script type="math/tex; mode=display">\alpha_t^k = P(X_t \vert Y_t = k) \sum\limits_i P(Y_t=k \vert Y_{t-1}=i) \alpha_{t-1}^i</script>

<p>Last:</p>

<script type="math/tex; mode=display">P(\mathbf{X}) = \sum\limits_i \alpha_T^i</script>

<p>Viterbi decoding can be done via MAP inference, replacing \(\sum\) with \( \max\) and keep the back pointers.</p>

<p><strong>Q</strong>: How to view this procedure in terms of junction tree algorithm?</p>

<h2 id="disclaimer">Disclaimer</h2>

<p>Some portions of the content are directly taken from the <a href="http://www.cs.cmu.edu/~epxing/Class/10708-14/lectures/lecture5-BP.pdf">slides</a> of CMU Probabilistic Graphical Model, 2014 by Eric Xing</p>

				</span>
				<div class="journal-date">Published 22 September 2015</div>
				<div class="journal-tags">
				
				
	 
		<a class="tag-cont" href="/tags.html#pgm-ref">
			<div class="tag-l"></div>
			<div class="tag-c">pgm</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#inference-ref">
			<div class="tag-l"></div>
			<div class="tag-c">inference</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#exact-inference-ref">
			<div class="tag-l"></div>
			<div class="tag-c">exact-inference</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#message-passing-ref">
			<div class="tag-l"></div>
			<div class="tag-c">message-passing</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#belief-propagation-ref">
			<div class="tag-l"></div>
			<div class="tag-c">belief-propagation</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#junction-tree-algorithm-ref">
			<div class="tag-l"></div>
			<div class="tag-c">junction-tree-algorithm</div>
			<div class="tag-r"></div>
		</a>
	



				</div>
			</div>
		</div>
		<div class="clearboth"></div>
	</div>
</div>
	<div class="clearboth"></div>
	


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'xiaohan2012'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




	<div class="clearboth"></div>
</div>


			</div>
			<div class="clearboth pagebottom"></div>
		</div>
	</div>
	<footer>
	<div class="footer-940">
		<div class="footer-general-info">
			© 2014 Han Xiao.<br><br>
			Content licensed under:<br>
			<a class="cc" href="http://creativecommons.org/licenses/by-sa/3.0/">c a b</a><br>
			<a href = "/about.html">About Me</a><br>
		</div>
		<div class="footer-col-cont">
			<div class="footer-nav-col">
				<h4><a>Categories</a></h4>
				<ul>
					
					


  
     
    	<li><a href="/categories.html#paper-reading-ref">
    		paper-reading <span>5</span>
    	</a></li>
     
    	<li><a href="/categories.html#experience-ref">
    		experience <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#misc-ref">
    		misc <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#software-ref">
    		software <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#note-ref">
    		note <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#study-note-ref">
    		study-note <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#resources-ref">
    		resources <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#paper-ref">
    		paper <span>12</span>
    	</a></li>
     
    	<li><a href="/categories.html#tutorial-ref">
    		tutorial <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#course-ref">
    		course <span>8</span>
    	</a></li>
     
    	<li><a href="/categories.html#thoughts-ref">
    		thoughts <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#resource-ref">
    		resource <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#weekly-summary-ref">
    		weekly-summary <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#modeling-ref">
    		modeling <span>1</span>
    	</a></li>
    
  


				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Pages</a></h4>
				<ul>
					
					
					


  
    
      
    
  
    
      
      	
      	<li><a href="/about.html">About Me</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Feed</a></h4>
				<ul>
					<li><a href="/atom.xml">Atom Feed</a></li>
					<li><a href="/rss.xml">RSS Feed</a></li>
				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Links</a></h4>
				<ul>
				 
					<li><a href = "http://xiaohan2012.github.io/">Han Xiao's Blog</a></li>
				
				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a href = "/about.html">About Me</a></h4>
				<ul>
				 
					<li><a href = "mailto:han.xiao@cs.helsinki.fi">e-mail</a></li>
				
				</ul>
			</div>
			<div class="clearboth"></div>
		</div>
		<div class="clearboth"></div>
	</div>
	<div class="clearboth"></div>
</footer>
	
</body>
</html>

