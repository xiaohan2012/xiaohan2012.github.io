
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	
	<title>Graphical Model: Exponential Family and Generalized Linear Models</title>
    
	
	<meta name="author" content="Han Xiao">
	
	<link rel="stylesheet" href="/assets/themes/Snail/css/jquery.fancybox.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/main.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/pages/journal.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/team.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/static.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/errors.css">
	<link rel="stylesheet" href="/assets/themes/Snail/google-code-prettify/prettify.css">
	<link rel="shortcut icon" href="/assets/themes/Snail/img/favicon.ico">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
	<script src="/assets/themes/Snail/google-code-prettify/prettify.js"></script>
	<script type="text/javascript">
	  $(function(){
		$("pre code").addClass("prettyprint linenums");
		prettyPrint();
	  });
	</script>
	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<!--[if lt IE 9]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">
</head>
<body>
	<noscript>
		&amp;lt;div id="no-js"&amp;gt;Please enable JavaScript in your browser to experience / fully&amp;lt;/div&amp;gt;
	</noscript>
    <div id="page-container">
		<div>
			<nav>
	<div id="nav-l">
	</div>
	<div id="nav-c">
		<ul id="nav-list" style="width: 700px;">
			<li id="home"><a href="/">Home</a></li>
			
			
			
				
				  
				
			 
				
				  
					
					<li id = "About Me"><a href="/about.html">About Me</a></li>
					
				  
				
			 
				
				  
					
					<li id = "Archive"><a href="/archive.html">Archive</a></li>
					
				  
				
			 
				
				  
				
			 
				
				  
					
					<li id = "Categories"><a href="/categories.html">Categories</a></li>
					
				  
				
			 
				
			 
				
				  
				
			 
				
				  
				
			 
				
				  
				
			 
				
				  
					
					<li id = "Tags"><a href="/tags.html">Tags</a></li>
					
				  
				
			 
			
			
		</ul>
		<form id="nav-search" method="GET" action="/search.html">
			<div id="search-right-pix">
				<div id="search-left-pix">
					<div id="search-center-pix">
						<div id="search-icon-pix"></div>
						<input name="query" type="text" placeholder="Search">
					</div>
				</div>
			</div>
		</form>
		
		
	</div>
	<div id="nav-r">
	</div>
</nav>
			<div id="page-content">
				
<div id="page-content">
	<div class="cont932">
	<div id="journal-articles-block">
		<div class="journal-article">
			<div class="journal-post-info">
				<div class="journal-cat-box">
				
				
				<div class="journal-cat-box">

<a href="/categories.html#course-ref" title="course">
	course

</a>
</div>
				
				</div>
			</div>
			<div class="journal-body">
				<h1 class="journal-title">Graphical Model: Exponential Family and Generalized Linear Models<span class="author"></span>
				</h1>
				<span class="the-article">
				<h2 id="exponential-family">Exponential family</h2>

<h3 id="why-do-we-study-it">Why do we study it?</h3>

<ul>
  <li>it’s a generic form for many ML models</li>
  <li>if we can apply generic parameter estimation method for this generic form, we can apply it to all its instance models</li>
</ul>

<h3 id="definition">Definition</h3>

<p>For any numerical random variable \(X\):</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{eqnarray*}
p(x \vert \eta)
&=&
h(x)\exp\{\eta^T T(x) - A(\eta)\} \\
&=&
\frac{1}{Z(x)}h(x)\exp\{\eta^T T(x)\} \\
\end{eqnarray*} %]]></script>

<p>is an exponential family distribution with natural parameter \(\eta\)</p>

<ul>
  <li>\(T(x)\): sufficient statistics</li>
  <li>\(h(x)\): for anything that is not interacting with the natural parameters(for example in Multivariate Gaussian)</li>
  <li>\(A(\eta)=\log Z(\eta)\): log normalizer</li>
</ul>

<h3 id="example">Example</h3>

<ul>
  <li>Fundamental models: Bernoulli, multinomial, Gaussian, Poisson, gamma,</li>
  <li>More complex ones: Ising model(MRS), RBM, CRF</li>
</ul>

<p>Benefit of CRF:</p>

<ul>
  <li>\(\mathbf{X}\) is assumed to be inter-dependent</li>
  <li>we can use global features on \(\mathbf{X}\)</li>
</ul>

<p>More examples:</p>

<ul>
  <li>Multivariate Gaussian: moment parameters, \(\sigma\) and \(\mu\)</li>
  <li>Multinomial distribution: \(\prod\limits_i^K \pi_i^{x_i} = \exp [\sum\limits_i x_i \ln \phi_i] \)</li>
</ul>

<h3 id="properties">Properties</h3>

<ul>
  <li><strong>Moment generating property</strong>: \(\frac{dA}{d\eta} = E[T(x)] = \mu \) and \( \frac{d^2A}{d\eta^2} = Var[T(x)] &gt; 0 \)</li>
  <li><strong>one-to-one correspondence between \(\mu\) and \(\eta\)</strong>: convexity of \(A(\eta)\)  =&gt; invertibily of \(\frac{dA}{d\eta} = E[T(x)] = \mu \) =&gt; \(\eta = \Psi(\mu)\)</li>
  <li><strong>moment matching</strong>: set \(\frac{\partial \mathcal{l}}{\partial \eta} = 0\) leads to <script type="math/tex">\mu_{MLE} = \frac{1}{N} \sum\limits_n T(X_n)</script> =&gt; <script type="math/tex">\eta_{MLE} = \Psi(\mu_{MLE})</script></li>
</ul>

<p>Moment estimation leads to parameter estimation</p>

<ul>
  <li><strong>Q</strong>: why do we need such moments?
 Moment is easily defined for exponential family and once we know the moment as well as the inverse function(from moment to parameter), we can get the parameter value quite easily</li>
  <li><strong>Q</strong>: how is the inverse function, \(\Psi\) defined?</li>
</ul>

<h3 id="sufficiency">Sufficiency</h3>

<p>Bayesian/Frequentist/Neyman View</p>

<p><strong>Q</strong>: why this views matter?</p>

<h3 id="exponential-family-and-bayesian">Exponential family and Bayesian</h3>

<p>Exponential family for both the model and prior</p>

<script type="math/tex; mode=display">P(X \vert \eta) = \exp \{\eta^T T(X) - A(\eta)\}</script>

<script type="math/tex; mode=display">P( \eta) = \exp \{\xi^T T(\eta) - A(\xi)\}</script>

<p>Then the posterior:</p>

<script type="math/tex; mode=display">P(\eta \vert X) = \exp \{\eta^T T(X) + \xi^T T(\eta) + A^{'} + A^{''}\}</script>

<p>If \(\eta = T(\eta)\), then</p>

<script type="math/tex; mode=display">P(\eta \vert X) = \exp \{T(\eta)(T(X) + \xi) + A^{'} + A^{''}\}</script>

<p>In this case, posterior is also exponential family.</p>

<p>Finally, if \( \eta = T(\eta)\),  \(P(\eta)\) is a conjugate prior for exponential family distribution.</p>

<h2 id="generalized-linear-modelsglims">Generalized Linear Models(GLIMs)</h2>

<h3 id="why-do-we-study-it-1">Why do we study it?</h3>

<p>It is a general form for regression and classification models.</p>

<h3 id="definition-1">Definition</h3>

<p><img src="/assets/images/pgm/glims-framework.png" alt="GLIMs framework" /></p>

<ul>
  <li>\(Y \sim exponential-Family\)</li>
  <li>\(\eta = \Psi(\mu = f(\xi = \theta^T X))\)</li>
</ul>

<p>GLIMs is a specific form of exponential family.</p>

<p>More:</p>

<ul>
  <li>Input, \(X\) enter the model through linear combination: \(\xi = \theta^T X\)</li>
  <li>Conditional mean, \(\mu=f(\xi)\), where \(f\) is response function.</li>
  <li>Output \(y\) characterized by exponential family distribution, \(p\), with conditional mean \(\mu\)</li>
</ul>

<p><strong>Canonical response function</strong>: simple case where\(f = \Psi^{-1}(.)\). Thus, \( \eta = \theta^T X\).</p>

<h3 id="examples">Examples</h3>

<ul>
  <li>Linear regression: \( P(Y \vert X, \theta) = N(\theta^T X, \sigma^2) \), \(\Psi, f\) both be identity function.</li>
  <li>Logistic regression: \(P(Y \vert X, \theta) = \mu(X)^Y (1-\mu(X))^(1-Y)\), where \( \mu(X) = sigmoid(X)\). \(f\) be sigmoid and \(\Psi\) be identity function.</li>
</ul>

<p>We can improve the input by transforming \(X\), for example, adding non-linearity.</p>

<ul>
  <li><strong>Q</strong>: what’s the connection between exponential family and GLIM?
In GLIM, the interaction between parameter and input is <strong>linear</strong>, however for exponential family, there is not such constraint.</li>
</ul>

<h2 id="mle-for-canonical-glim">MLE for Canonical GLIM</h2>

<p>Derivative of log-likelihood leads to:</p>

<script type="math/tex; mode=display">\frac{\mathbf{l}}{\theta} = X^T (y - \mu)</script>

<p>Need to solve it iteratively.</p>

<h3 id="online-learning">Online learning</h3>

<p>One option is SGD, the update rule is:</p>

<script type="math/tex; mode=display">\theta_{new} = \theta_{old} + \alpha (y_n - \mu_n)x_n</script>

<p>\(\alpha\) is the learning rate, which needs to be set.</p>

<h3 id="batching-learning-using-iterative-reweighting-least-squareirls">Batching learning using Iterative Reweighting Least Square(IRLS)</h3>

<p>\( \alpha\) needs to be set. Hessian can be used to adjust the learning rate.</p>

<p>This gives rise to Newton Raphson method with cost function \(J\):</p>

<script type="math/tex; mode=display">\theta_{new} = \theta_{old} - H^{-1} \nabla_{\theta} J</script>

<p>General form of Hessian \( H\) for GLIMs:</p>

<script type="math/tex; mode=display">H = \frac{d^2 \mathbf{l}}{d\theta\theta} = -X^T W X</script>

<p>Newton Raphson method for GLIMs is called Iteratively Reweighting Least Squares(IRLS), as it takes the form:</p>

<p><script type="math/tex">\theta_{new} = (X^TW_{old}X)^{-1}X^TW_{old}z_{old}</script>, where <script type="math/tex">z_{old} = X \theta_{old} + W_{old}^{-1}(y-u_{old})</script></p>

<p>which is similar to Least Square case, where \( \theta^* = (X^TX)^{-1}X^Ty\).</p>

<p>In IRLS, we iteratively reweight objective function using \(W\) and solve <script type="math/tex">\theta^{new} = argmin_{\theta} (z - X\theta_{old})^T W (z - X\theta_{old})</script>.</p>

<p>This method is generic for any exponential family distribution, the difference is \(W\).</p>

<p>Example:</p>

<ul>
  <li>logistic regression</li>
  <li>linear regression: \(W=1\)</li>
</ul>

<p>The take-home stuff is: <strong>generic</strong> MLE for exponential family and GLIMs using IRLS.</p>

<ul>
  <li><strong>Q</strong>: For the above, we only talked about natural/canonical response function, which limits the scope. What about other response functions(e.g, sigmoid)?</li>
</ul>

<h2 id="summary">Summary</h2>

<ol>
  <li>Exponential family and MLE amounts to moment matching</li>
  <li>GLIMs, its canonical version and MLE on it using IRLS</li>
</ol>

<h2 id="disclaimer">Disclaimer</h2>

<p>Some portions of the content are directly taken from the <a href="http://www.cs.cmu.edu/~epxing/Class/10708-14/lectures/lecture6-GLIM.pdf">slides</a> of CMU Probabilistic Graphical Model, 2014 by Eric Xing</p>

				</span>
				<div class="journal-date">Published 23 September 2015</div>
				<div class="journal-tags">
				
				
	 
		<a class="tag-cont" href="/tags.html#pgm-ref">
			<div class="tag-l"></div>
			<div class="tag-c">pgm</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#exponential-family-ref">
			<div class="tag-l"></div>
			<div class="tag-c">exponential-family</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#glim-ref">
			<div class="tag-l"></div>
			<div class="tag-c">glim</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#newton-raphson-ref">
			<div class="tag-l"></div>
			<div class="tag-c">newton-raphson</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#mle-ref">
			<div class="tag-l"></div>
			<div class="tag-c">mle</div>
			<div class="tag-r"></div>
		</a>
	



				</div>
			</div>
		</div>
		<div class="clearboth"></div>
	</div>
</div>
	<div class="clearboth"></div>
	


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'xiaohan2012'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




	<div class="clearboth"></div>
</div>


			</div>
			<div class="clearboth pagebottom"></div>
		</div>
	</div>
	<footer>
	<div class="footer-940">
		<div class="footer-general-info">
			© 2014 Han Xiao.<br><br>
			Content licensed under:<br>
			<a class="cc" href="http://creativecommons.org/licenses/by-sa/3.0/">c a b</a><br>
			<a href = "/about.html">About Me</a><br>
		</div>
		<div class="footer-col-cont">
			<div class="footer-nav-col">
				<h4><a>Categories</a></h4>
				<ul>
					
					


  
     
    	<li><a href="/categories.html#paper-reading-ref">
    		paper-reading <span>5</span>
    	</a></li>
     
    	<li><a href="/categories.html#experience-ref">
    		experience <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#misc-ref">
    		misc <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#software-ref">
    		software <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#note-ref">
    		note <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#study-note-ref">
    		study-note <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#resources-ref">
    		resources <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#paper-ref">
    		paper <span>12</span>
    	</a></li>
     
    	<li><a href="/categories.html#tutorial-ref">
    		tutorial <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#course-ref">
    		course <span>8</span>
    	</a></li>
     
    	<li><a href="/categories.html#thoughts-ref">
    		thoughts <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#resource-ref">
    		resource <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#weekly-summary-ref">
    		weekly-summary <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#modeling-ref">
    		modeling <span>1</span>
    	</a></li>
    
  


				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Pages</a></h4>
				<ul>
					
					
					


  
    
      
    
  
    
      
      	
      	<li><a href="/about.html">About Me</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Feed</a></h4>
				<ul>
					<li><a href="/atom.xml">Atom Feed</a></li>
					<li><a href="/rss.xml">RSS Feed</a></li>
				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Links</a></h4>
				<ul>
				 
					<li><a href = "http://xiaohan2012.github.io/">Han Xiao's Blog</a></li>
				
				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a href = "/about.html">About Me</a></h4>
				<ul>
				 
					<li><a href = "mailto:han.xiao@cs.helsinki.fi">e-mail</a></li>
				
				</ul>
			</div>
			<div class="clearboth"></div>
		</div>
		<div class="clearboth"></div>
	</div>
	<div class="clearboth"></div>
</footer>
	
</body>
</html>

