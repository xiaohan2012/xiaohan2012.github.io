
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	
	<title>Study Note: Introduction to Monte Carlo Method</title>
    
	
	<meta name="author" content="Han Xiao">
	
	<link rel="stylesheet" href="/assets/themes/Snail/css/jquery.fancybox.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/main.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/pages/journal.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/team.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/static.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/errors.css">
	<link rel="stylesheet" href="/assets/themes/Snail/google-code-prettify/prettify.css">
	<link rel="shortcut icon" href="/assets/themes/Snail/img/favicon.ico">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
	<script src="/assets/themes/Snail/google-code-prettify/prettify.js"></script>
	<script type="text/javascript">
	  $(function(){
		$("pre code").addClass("prettyprint linenums");
		prettyPrint();
	  });
	</script>
	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<!--[if lt IE 9]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">
</head>
<body>
	<noscript>
		&amp;lt;div id="no-js"&amp;gt;Please enable JavaScript in your browser to experience / fully&amp;lt;/div&amp;gt;
	</noscript>
    <div id="page-container">
		<div>
			<nav>
	<div id="nav-l">
	</div>
	<div id="nav-c">
		<ul id="nav-list" style="width: 700px;">
			<li id="home"><a href="/">Home</a></li>
			
			
			
				
				  
				
			 
				
				  
					
					<li id = "About Me"><a href="/about.html">About Me</a></li>
					
				  
				
			 
				
				  
					
					<li id = "Archive"><a href="/archive.html">Archive</a></li>
					
				  
				
			 
				
				  
				
			 
				
				  
					
					<li id = "Categories"><a href="/categories.html">Categories</a></li>
					
				  
				
			 
				
			 
				
				  
				
			 
				
				  
				
			 
				
				  
				
			 
				
				  
					
					<li id = "Tags"><a href="/tags.html">Tags</a></li>
					
				  
				
			 
			
			
		</ul>
		<form id="nav-search" method="GET" action="/search.html">
			<div id="search-right-pix">
				<div id="search-left-pix">
					<div id="search-center-pix">
						<div id="search-icon-pix"></div>
						<input name="query" type="text" placeholder="Search">
					</div>
				</div>
			</div>
		</form>
		
		
	</div>
	<div id="nav-r">
	</div>
</nav>
			<div id="page-content">
				
<div id="page-content">
	<div class="cont932">
	<div id="journal-articles-block">
		<div class="journal-article">
			<div class="journal-post-info">
				<div class="journal-cat-box">
				
				
				<div class="journal-cat-box">

<a href="/categories.html#study-note-ref" title="study-note">
	study-note

</a>
</div>
				
				</div>
			</div>
			<div class="journal-body">
				<h1 class="journal-title">Study Note: Introduction to Monte Carlo Method<span class="author"></span>
				</h1>
				<span class="the-article">
				<p>This is the study note of this <a href="http://leonidzhukov.net/hse/2013/stochmod/papers/intro_to_mcmc_mackay.pdf">Introduction to Monte Carlo Methods</a></p>

<h2 id="introduction">Introduction</h2>

<p>Problem we are facing:</p>

<ol>
  <li>To generate samples from \(P(x)\).</li>
  <li>To estimate the expectation under the distribution.</li>
</ol>

<p>If we know 1, the 2 can be solved by sampling.</p>

<p>Assume \(P(x)\) can be <em>evaluated</em> to be multiplicative constant, that is</p>

<script type="math/tex; mode=display">P(x) = P^{*}(x) / Z</script>

<p>Where \(Z\) is the normalising constant.</p>

<p><strong>My questions</strong>:</p>

<ul>
  <li>why called <strong>evaluated</strong> and how is it done?</li>
  <li>why it is a multiplicative constant, not additive constant?</li>
</ul>

<p>But sampling from \(P(x)\) is still difficult because:</p>

<ol>
  <li>\(Z\) is unknown.</li>
  <li>Even if \(Z\) is known, sampling(especially from high-dimensional space) is challenging for computers(in the numerical sense), because knowing how to <strong>plot</strong> the density function does not necessarily mean it is easy to <strong>sample</strong> from it.</li>
</ol>

<p>Let’s assume we have the explicit form of the distirbution we want to sample from.  We can discretize the x axis and make the plot into a list of bins. Then use uniform distribution to sample based on the height of the bins.</p>

<p>The essay’s idea is that given \( P^{*}(x) \), in order to get \(P(X)\), we need to calculate \(Z\). Given high data dimension, the state space is large.</p>

<p><strong>My questions</strong>:</p>

<ul>
  <li>Can I say discretization is the general approach to sample numerically?</li>
  <li>\(Z\) seems to be an important element, but why do we introduce it? Again, how \( P^{*}(x) \) is retrieved.</li>
</ul>

<h2 id="uniform-sampling">Uniform Sampling</h2>

<p>We can use sampling to estimate the expectation. But given the existence of typical set especially for high dimensional data. It is often fairly possible not to hit any point in the typical set at all when doing the sampling!</p>

<p>So we need to use different sampling methods.</p>

<h2 id="importance-sampling">Importance Sampling</h2>

<p>This is used to solve the expectation estimation problem.</p>

<h3 id="basic-idea">Basic Idea</h3>

<p>Given that we know the form of the density function, \(P(x)\), which could be hard to sample from, we use a simpler density function to approximate the \(P(x)\). And we call it sampler density and denote it as \(Q(x)\), which could be a Gaussian or Cauchy distribution.</p>

<p>As their might be inaccuracy when sampling from \(Q(x)\) compared to the original \(P(x)\), we introduce a weight, \( P(x_i) / Q(x_i) \) to modify the effect of the sampling points.</p>

<p>For example, if \( Q(x_i) &gt; P(x_i) \), \( x_i \) is over-presented, a weight, \( P(x_i) / Q(x_i) \) below 1, is multiplied to the value \( \phi_{x_i} \). The idea goes vice versa.</p>

<p>And as the sampling goes on, it is proved to converge.</p>

<h3 id="practical-problem">Practical Problem</h3>

<p>There might be region where \(Q(x)\) is small while \(P(x)\) are large and \( \phi(x)P(x) \) are large. Then x might had little chance falling into that region. And the big contribution from that region is absent</p>

<p>In one example provided by the author, Cauchy sampler is used and converges only after 5000 samplings, while Gaussian sampler does not converge even after ten thousand samplings.</p>

<p>In contrast, Cauchy sampler has heavier tails than Gaussian sampler.</p>

<h3 id="multiple-dimension">Multiple Dimension</h3>

<p>Assume a uniform distribution inside a sphere, the proposal density is multi dimensional Guassian.</p>

<p>It can be shown that the weights of several sample points will dominate the others. For \(N=1000\), the largest weight will be \( 10^{19} \) larger than the median weight.</p>

<p>Problem with importance sampling:</p>

<ol>
  <li>\(Q\) should be a good approximation of \(P\) so that \(Q\) lies in the typical set of \(P\). It could take time to find. BTW, how to find?</li>
  <li>Large weights are likely to dominate by exponential factor.</li>
</ol>

<h2 id="rejection-sampling">Rejection Sampling</h2>

<h3 id="basic-idea-1">Basic Idea</h3>
<p>Let’s use a one dimentional example. Sampling from \(P(x)\) is equavalent to uniformly sampling from the <strong>area</strong> of its plot.</p>

<p>We can define another distribution, \(Q(x)\), which hopefully approximates well \(P(x)\). Before sampling we must make sure that \(Q(x)\) is larger than \(P(x)\) up to a multiplicative factor. That is:</p>

<p>\( P(x) &lt; c \cdot Q(x) \) for all \(x\)</p>

<p>We first sample from \(Q(x)\), then do a uniform sampling from \( [0, c \cdot Q(x)] \). If the value is less than \(P(x)\), we <em>accept</em> the sample. Otherwise, we <em>reject</em> it.</p>

<p>In this way, we can make sure that we are sampling uniformly from the area of the plot.</p>

<p>However, this requires that \(Q(x)\) approximates \(P(x)\) well, otherwise, c could be very large. Consequently, acceptance will be very rare.</p>

<h3 id="problem">Problem</h3>
<p>For high-dimensional data, it is hard to find the value of c as we enumerating all values of \(P(x)\) is computationally expensive.</p>

<p>Also, c could be very large(approximately 20,000) even for two normal distributions, \(P(x)\) and \(Q(x)\) where the std of \(Q(x)\) is only 1% larger than \(P(x)\).</p>

<p>The acceptance ratio(volume under \(P(x)\) to volume under c \(Q(x)\) ) will be 1/20,000. And volume under \(P(x)\) and \(Q(x)\) are 1(normalized).</p>

<h2 id="metropolis-method">Metropolis method</h2>

<h3 id="basic-idea-2">Basic Idea</h3>
<p>Essentially a random walk method.</p>

<p>Acceptance:</p>

<p>If the move is accepted, we are in a new state. If not, we have some chances(equal to the acceptance probability) of moving to the new state.</p>

<h3 id="lower-bound-for-iteration-number">Lower Bound for Iteration Number</h3>

<p>Approximately equal to  \( (L / \sigma)^{2} \)</p>

<ul>
  <li>\(L\): largest length scale of the state space.</li>
</ul>

<h3 id="self-question-and-answering">Self Question and Answering</h3>

<ol>
  <li>**What is the intuition of sampling in Markov way? **</li>
</ol>

<p>Random walk(current walk depends on the previous state/position) on the landscape of the target density function hoping to cover almost every where.</p>

<ol>
  <li><strong>Why use such a formula to determine acceptance?</strong></li>
</ol>

<p><a href="http://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm#Formal_derivation_of_the_Metropolis-Hastings_algorithm">This Wikipedia page</a> explains it.</p>

<ol>
  <li>**What is the form of \( Q(x^{‘}, x_i) \)? How could Q change based on the current state \( x_i \)? **</li>
</ol>

<p>Remeber the \(Q\) function essentially implements the random walk mechanism. For example we can move left or right by 1 unit. This equals to \( Q(x_i, x^{‘}) = 1/2 \) if \( x_i = x^{‘} \pm 1 \).</p>

<ol>
  <li>**How is dependent sampling turn into independent samples after certain amount of iterations? **</li>
</ol>

<p>Intuitively, it seems to be the case once you have being randomly walking for a long long time. Then the places you hace been to seems to be independent.</p>

<ol>
  <li>**Why the name involves Metropolis? **</li>
</ol>

<p>My guess: let’s imaging someone wandering in a big city?</p>

<ol>
  <li><strong>How does the Rule of Thumb come about?</strong></li>
</ol>

<p>I can only figure it out for two dimensional space.</p>

<p>Gibbs sampling will be posted next.</p>

				</span>
				<div class="journal-date">Published 03 September 2014</div>
				<div class="journal-tags">
				
				
	 
		<a class="tag-cont" href="/tags.html#mcmc-ref">
			<div class="tag-l"></div>
			<div class="tag-c">mcmc</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#importance-sampling-ref">
			<div class="tag-l"></div>
			<div class="tag-c">importance-sampling</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#rejection-sampling-ref">
			<div class="tag-l"></div>
			<div class="tag-c">rejection-sampling</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#metropolis-sampling-ref">
			<div class="tag-l"></div>
			<div class="tag-c">metropolis-sampling</div>
			<div class="tag-r"></div>
		</a>
	



				</div>
			</div>
		</div>
		<div class="clearboth"></div>
	</div>
</div>
	<div class="clearboth"></div>
	


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'xiaohan2012'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




	<div class="clearboth"></div>
</div>


			</div>
			<div class="clearboth pagebottom"></div>
		</div>
	</div>
	<footer>
	<div class="footer-940">
		<div class="footer-general-info">
			© 2014 Han Xiao.<br><br>
			Content licensed under:<br>
			<a class="cc" href="http://creativecommons.org/licenses/by-sa/3.0/">c a b</a><br>
			<a href = "/about.html">About Me</a><br>
		</div>
		<div class="footer-col-cont">
			<div class="footer-nav-col">
				<h4><a>Categories</a></h4>
				<ul>
					
					


  
     
    	<li><a href="/categories.html#paper-reading-ref">
    		paper-reading <span>5</span>
    	</a></li>
     
    	<li><a href="/categories.html#experience-ref">
    		experience <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#misc-ref">
    		misc <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#software-ref">
    		software <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#note-ref">
    		note <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#study-note-ref">
    		study-note <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#resources-ref">
    		resources <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#paper-ref">
    		paper <span>12</span>
    	</a></li>
     
    	<li><a href="/categories.html#tutorial-ref">
    		tutorial <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#course-ref">
    		course <span>8</span>
    	</a></li>
     
    	<li><a href="/categories.html#thoughts-ref">
    		thoughts <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#resource-ref">
    		resource <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#weekly-summary-ref">
    		weekly-summary <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#modeling-ref">
    		modeling <span>1</span>
    	</a></li>
    
  


				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Pages</a></h4>
				<ul>
					
					
					


  
    
      
    
  
    
      
      	
      	<li><a href="/about.html">About Me</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Feed</a></h4>
				<ul>
					<li><a href="/atom.xml">Atom Feed</a></li>
					<li><a href="/rss.xml">RSS Feed</a></li>
				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Links</a></h4>
				<ul>
				 
					<li><a href = "http://xiaohan2012.github.io/">Han Xiao's Blog</a></li>
				
				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a href = "/about.html">About Me</a></h4>
				<ul>
				 
					<li><a href = "mailto:han.xiao@cs.helsinki.fi">e-mail</a></li>
				
				</ul>
			</div>
			<div class="clearboth"></div>
		</div>
		<div class="clearboth"></div>
	</div>
	<div class="clearboth"></div>
</footer>
	
</body>
</html>

